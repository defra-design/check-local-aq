{% from "govuk/components/table/macro.njk" import govukTable %}

{% set rows = [] %}
{% for station in measurementStations %}
  {% set row = [
    {
      html: '<a href="/stations/' + (station.slug | default("missing-slug")) + '">' + (station.station_name | default("Missing Name")) + '</a>'
    }, 
    {
      text: (station.average_daqi_value | default("Missing Average Value"))
    },   
    {
      html: ' <strong class="daqi-tag daqi-tag--' + (station.average_daqi_value | default("missing-value")) + '">' + (station.average_daqi_label | default("Missing Average Label")) + '</strong>'
    }
  ] %}
  {% set _ = rows.push(row) %}
{% endfor %}

{{ govukTable({
  classes: "govuk-!-margin-bottom-8",
  caption: "Nearest measurement stations",
  captionClasses: "govuk-table__caption--m govuk-!-margin-top-4 govuk-!-margin-bottom-4",
  firstCellIsHeader: true,
  head: [
    {
      text: "Measurement station",
      classes: "govuk-!-width-one-quarters"
    },
    {
      text: "Index"
    },
    {
      text: "Pollution level"
    }
  ],
  rows: rows
}) }}
