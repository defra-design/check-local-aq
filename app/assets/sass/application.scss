//
// For guidance on how to add CSS and SCSS see:
// https://prototype-kit.service.gov.uk/docs/adding-css-javascript-and-images
// 

// GOV UK breakpoints
$govuk-breakpoints: (
  mobile:  320px,
  tablet:  641px,
  desktop: 835px
) !default;

@mixin defra-visually-hidden() {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: 0;
  padding: 0;
  overflow: hidden;
  clip: rect(0 0 0 0);
  -webkit-clip-path: inset(50%);
  clip-path: inset(50%);
  border: 0;
  white-space: nowrap;
}


// Table
.app-table--daqi {
  border-collapse: separate;
  border: 0;
}

.daqi-table__header {
  @include govuk-font($size: 16, $weight: regular);
  border: 0;
  padding: govuk-spacing(2);
  vertical-align: bottom;
  text-align: center;
  width: 10%;
  border-right: 3px solid white; /* Add a 3px white vertical border to header cells */
}

.daqi-table__header:last-child {
  padding: govuk-spacing(2) govuk-spacing(2) govuk-spacing(2) 9px;
}

.daqi-table__cell {
  @include govuk-font($size: 16, $weight: regular);
  padding-top: govuk-spacing(2);
  padding-bottom: govuk-spacing(2);
  padding-left: 0;
  padding-right: 0;
  text-align: center;
  border: 0;
  width: 10%;
  background-color: govuk-colour("light-grey");
  border-right: 2px solid white; /* Add a 3px white vertical border to data cells */
}

// .daqi-table__cell:last-child {
//   padding: govuk-spacing(2) govuk-spacing(2) govuk-spacing(2) 9px;
// }

.daqi-table__caption {
  font-weight: 700;
  text-align: left;
  
}

.daqi-band {
  @include govuk-font($size: 14, $weight: regular);
  border: 0;
  vertical-align: top;
  text-align: left;
  width: 10%;
  border-right: 3px solid white; /* Add a 3px white vertical border to cells in .daqi-band */
}

.daqi-band:last-child {
  text-align: right;
}


// DAQI colours

$daqi-colour-0: govuk-colour("light-grey");
$daqi-colour-1: govuk-colour("green");
$daqi-colour-2: govuk-colour("green");
$daqi-colour-3: govuk-colour("green");
$daqi-colour-4: govuk-colour("yellow");
$daqi-colour-5: govuk-colour("yellow");
$daqi-colour-6: govuk-colour("yellow");
$daqi-colour-7: govuk-colour("red");
$daqi-colour-8: govuk-colour("red");
$daqi-colour-9: govuk-colour("red");
$daqi-colour-10: govuk-colour("purple");
  
  
  // DAQI table

  .daqi-selected {
    font-weight: bold; 
  }

  .daqi-0 {
    background-color: $daqi-colour-0;
    color: govuk-colour("black");
  }

  .daqi-1 {
    background-color: $daqi-colour-1;
    color: govuk-colour("white");
    font-weight: bold; 
  }
  
  .daqi-2 {
    background-color: $daqi-colour-2;
    color: govuk-colour("white");
    font-weight: bold; 
  }
  
  .daqi-3 {
    background-color: $daqi-colour-3;
    color: govuk-colour("white");
    font-weight: bold; 
  }
  
  .daqi-4 {
    background-color: $daqi-colour-4;
    color: govuk-colour("black");
    font-weight: bold; 
  }
  
  .daqi-5 {
    background-color: $daqi-colour-5;
    color: govuk-colour("black");
    font-weight: bold; 
  }
  
  .daqi-6 {
    background-color: $daqi-colour-6;
    color: govuk-colour("black");
    font-weight: bold; 
  }
  
  .daqi-7 {
    background-color: $daqi-colour-7;
    color: govuk-colour("white");
    font-weight: bold; 
  }
  
  .daqi-8 {
    background-color: $daqi-colour-8;
    color: govuk-colour("white");
    font-weight: bold; 
  }
  
  .daqi-9 {
    background-color: $daqi-colour-9;
    color: govuk-colour("white");
    font-weight: bold; 
  }
  
  .daqi-10 {
    background-color: $daqi-colour-10;
    color: govuk-colour("white");
    font-weight: bold; 
}


@for $i from 0 through 10 {
  .daqi-#{$i} {
    text-align: center;
  }
}




//DAQI Tag

.daqi-tag {

  display: inline-block;

  // When a user customises their colours often the background is removed,
  // by adding a outline we ensure that the tag component still keeps it's meaning.
  // https://accessibility.blog.gov.uk/2017/03/27/how-users-change-colours-on-websites/
  outline: 2px solid transparent;
  outline-offset: -2px;

  color: govuk-colour("white");
  background-color: govuk-colour("blue");
  letter-spacing: 1px;

  text-decoration: none;

  @if $govuk-use-legacy-font {
    // Since New Transport sits slightly higher than other common fonts.
    // We use intentionally uneven padding to make it balanced, this can be
    // removed using the version of the font that has a more common vertical spacing.
    @include govuk-font($size: 16, $weight: regular, $line-height: 1.25);
    padding-top: 4px;
    padding-right: 8px;
    padding-bottom: 1px;
    padding-left: 8px;
  } @else {
    @include govuk-font($size: 16, $weight: regular, $line-height: 1);
    padding-top: 5px;
    padding-right: 8px;
    padding-bottom: 4px;
    padding-left: 8px;
  }
}

.daqi-tag--round {
  border-radius: 50%; 
}

mark {
  background-color: transparent;
  font-weight: bold;
  color: inherit;
}

.daqi-tag--1 {
  color: govuk-colour("white");
  background: $daqi-colour-1;
}

.daqi-tag--2 {
  color: govuk-colour("white");
  background: $daqi-colour-2;
}

.daqi-tag--3 {
  color: govuk-colour("white");
  background: $daqi-colour-3;
}

.daqi-tag--4 {
  color: govuk-colour("black");
  background: $daqi-colour-4;
}

.daqi-tag--5 {
  color: govuk-colour("black");
  background: $daqi-colour-5;
}

.daqi-tag--6 {
  color: govuk-colour("black");
  background: $daqi-colour-6;
}

.daqi-tag--7 {
  color: govuk-colour("white");
  background: $daqi-colour-7;
}

.daqi-tag--8 {
  color: govuk-colour("white");
  background: $daqi-colour-8;
}

.daqi-tag--9 {
  color: govuk-colour("white");
  background: $daqi-colour-9;
}

.daqi-tag--10 {
  color: govuk-colour("white");
  background: $daqi-colour-10;
}


// Pollutants

.pollutant-value {
    margin-bottom: govuk-spacing(0);
  }

// Section

.app-section__heading {
    border-top: 2px solid govuk-colour("black");
    margin: 0 0 govuk-spacing(6);
    padding: govuk-spacing(6) 0 0;
}


//Forecast Panel

@for $i from 1 through 3 {
  .daqi-panel--#{$i} {
    border-left: 10px solid $daqi-colour-1;
    background-color: #fdedee;
  }
}

@for $i from 4 through 6 {
  .daqi-panel--#{$i} {
    border-left: 10px solid $daqi-colour-4;
    background-color: #fdedee;
  }
}

@for $i from 7 through 9 {
  .daqi-panel--#{$i} {
    border-left: 10px solid $daqi-colour-7;
  }
}

.daqi-panel {
  border-left: 10px solid $daqi-colour-10;
  background-color: #fdedee;
}


.defra-toggletip {
	// height: 1rem;
	&:first-child {
		display: inline-block;
	}
  display: inline-block;
  position: relative;
	&:not(.defra-toggletip-target) {
		padding-right: 26px;
	}
	&--open {
		z-index: 99;
	}
	&__container {
		position: absolute;
		top: -3px;
		@include mq ($from: tablet) {
			top: -1px;
		}
		right: 0px;
		width: 26px;
		height: 26px;
	}
	&__button {
		position: absolute;
		top: 0px;
		left: 0px;
		width: 26px;
		height: 26px;
		background-color: white;
		border: 0px;
		padding: 0px;
		text-align: center;
		color: $govuk-text-colour;
		cursor: help;
		&-icon {
			pointer-events: none;
			position: absolute;
			overflow: visible;
			top: 5px;
			left: 5px;
			width: 16px;
			height: 16px;
			border-radius: 100%;
		}
		&-text {
			@include defra-visually-hidden();
		}
		svg {
			position: relative;
			margin: -1px 0px 0px -1px;
		}
		&:hover, &:focus {
			color: govuk-colour('black');
		}
		&:hover span {
			box-shadow: 0 0 0 5px govuk-colour('light-grey');
		}
		&:focus {
			outline: 3px solid transparent;
			span {
				box-shadow: 0 0 0 1px govuk-colour('black'), 0 0 0 5px $govuk-focus-colour;
			}
		}
	}
	&__info {
		@include govuk-font($size: 16);
		cursor: auto;
		position:absolute;
		width:0px;
		overflow: hidden;
		box-sizing: border-box;
		visibility: hidden;
		top: auto;
		bottom: 100%;
		left: 0px;
		padding-bottom: 10px;
		text-align: left;
	}
	&__text {
		position: relative;
		display:block;
		box-sizing: border-box;
		padding: 7.5px 10px;
		color: govuk-colour('black');
		background: currentcolor;
		border: 2px solid currentcolor;
		z-index: 2;
		span {
			color: white;
		}
	}
	&__arrow {
		position: absolute;
		box-sizing: border-box;
		z-index: 1;
		width: 10px;
		height: 10px;
		left: 50%;
		bottom: auto;
		top: 100%;
		margin: -15px 0px 0px -5px;
		color: govuk-colour('black');
		border: 5px solid currentcolor;
		-webkit-transform: rotate(135deg);
		-moz-transform: rotate(135deg);
		-o-transform: rotate(135deg);
		transform: rotate(135deg);
	}
	&--bottom &__info {
		bottom: auto;
		top: 100%;
		padding-top: 10px;
		padding-bottom: 0px;
	}
	&--bottom &__arrow {
		bottom: 100%;
		top: auto;
		margin: 0px 0px -15px -5px;
	}
	&--open &__info {
		visibility: visible;
		width:200px;
		overflow: visible;
	}
	&.defra-toggletip-target {
		cursor: help;
		border-bottom: 1px dashed govuk-colour('black');
		padding-bottom: 1px;
		outline: 3px solid transparent;
		&:focus, &:hover:focus-visible {
			border-bottom: 1px solid govuk-colour('black');
			box-shadow: 0 2px 0 govuk-colour('black'), 0 6px 0 govuk-colour('yellow');
		}
		&:focus:not(:focus-visible):not(:hover) {
			border-bottom: 1px dashed govuk-colour('black');
			box-shadow: none;
		}
		&:hover {
			border-bottom: 1px solid govuk-colour('black');
			box-shadow: 0 2px 0 govuk-colour('black');
		}
	}
}

//Utility classes

.align-middle {
  vertical-align: middle;
}

.govuk-caption-s {
  @extend .govuk-caption-m;
  @include govuk-font($size: 16);
}

.defra-aq-levels-table {
  @extend .govuk-table;
  position: relative;
  margin-top: -1px;
  margin-bottom: 0px;
  @include mq ($until: tablet) {
    display: block;
  }
  &__head {
    @include mq ($until: tablet) {
      display: block;
    }   
  }
  &__head tr {
    @include mq ($until: tablet) {
      display: flex;
      flex-wrap: wrap;
    }
  }
  &__head &__cell {
    text-align: left;
    padding-top: 20px;
    padding-bottom: 20px;
    &--pollutant {
      @include mq ($until: tablet) {
        @include defra-visually-hidden();
      }
    }
  }
  &__body {
    @include mq ($until: tablet) {
      display: block;
    }
  }
  &__row {
    border-top: 1px solid govuk-tint($govuk-border-colour, 0);
    border-bottom: 1px solid govuk-tint($govuk-border-colour, 0);
    @include mq ($until: tablet) {
      position: relative;
      display: flex;
      flex-wrap: wrap;
      margin-bottom: -1px;
    }
  }
  &__cell {
    @extend .govuk-table__cell;
    border-bottom: 0px;
    vertical-align: middle;
    text-align: left;
    padding-left: 0px;
    padding-right: 0px;
    @include mq ($until: tablet) {
      display: inline-block;
      padding-top:0px;
      padding-bottom: 10px;
    }
    a {
      display: inline-block;
    }
    a:not(:hover) {
      text-decoration: none;
    }
  }
  &__cell--pollutant {
    @include govuk-font($size: 19, $weight: bold);
    width: 40%;
    padding-right:20px;
    @include mq ($until: tablet) {
      padding-top:10px;
      padding-bottom:5px;
      padding-right: 0px;
      width: 100%;
    }
  }
  &__cell--reading {
    @include govuk-font($size: 19, $weight: bold);
    width: 20%;
    @include mq ($until: tablet) {
      width: 35%;
      //flex: 1 1 1em;
    }
  }
  &__cell--trend {
    width: 20%;
    @include mq ($until: tablet) {
      width: 30%;
      //flex: 1 1 3.5em;
    }
  }
  &__cell--level {
    width: 20%;
    @include mq ($until: tablet) {
      width: 35%;
      //flex: 1 1 0.5em;
    }
  }
}


.defra-daqi-levels-table {
  @extend .govuk-table;
  position: relative;
  margin-top: -1px;
  margin-bottom: 0px;
  @include mq ($until: tablet) {
    display: block;
  }
  &__head {
    @include mq ($until: tablet) {
      display: block;
    }   
  }
  &__head tr {
    @include mq ($until: tablet) {
      display: flex;
      flex-wrap: wrap;
    }
  }
  &__head &__cell {
    text-align: left;
    padding-top: 20px;
    padding-bottom: 20px;
    &--pollutant {
      @include mq ($until: tablet) {
        @include defra-visually-hidden();
      }
    }
  }
  &__body {
    @include mq ($until: tablet) {
      display: block;
    }
  }
  &__row {
    border-top: 1px solid govuk-tint($govuk-border-colour, 0);
    border-bottom: 1px solid govuk-tint($govuk-border-colour, 0);
    @include mq ($until: tablet) {
      position: relative;
      display: flex;
      flex-wrap: wrap;
      margin-bottom: -1px;
    }
  }
  &__cell {
    @extend .govuk-table__cell;
    border-bottom: 0px;
    //vertical-align: middle;
    text-align: left;
    padding-left: 0px;
    padding-right: 0px;
    @include mq ($until: tablet) {
      display: inline-block;
      padding-top:0px;
      padding-bottom: 10px;
    }
  }
  &__cell--advice {
    @include govuk-font($size: 19, $weight: bold);
    width: 40%;
    padding-right:20px;
    @include mq ($until: tablet) {
      padding-top:10px;
      padding-bottom:5px;
      padding-right: 0px;
      width: 100%;
    }
  }
  &__cell--level {
    @include govuk-font($size: 19, $weight: bold);
    width: 20%;
    @include mq ($until: tablet) {
      width: 50%;
      //flex: 1 1 1em;
    }
  }
  &__cell--index {
    width: 20%;
    @include mq ($until: tablet) {
      width: 50%;
      //flex: 1 1 3.5em;
    }
  }
}






